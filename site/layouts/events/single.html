{{/* 
  single page app for one or more events
*/}}
{{ define "html_header" }}
  {{ partial "head-content.html" . }}
  <link rel="stylesheet" type="text/css" href="/css/events.css"/>
{{ end }}
{{ define "html_body" }}
{{/* fix: should be local includes */}}
<script type="importmap">
  {
    "imports": {
      "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js",
      "vue-router": "https://unpkg.com/vue-router@4.3.0/dist/vue-router.esm-browser.js",
      "@vue/devtools-api": "https://unpkg.com/@vue/devtools-api@6.6.1/lib/esm/index.js"
    }
  }
</script>
{{/* 
  site menu, generated from hugo.toml.
  outputs to a json file, that we can include.
*/}}
{{ $menu := partial "buildMenu.html" site.Menus.main }}
{{ $json := ( $menu | jsonify (dict "prefix" " " "indent" "  "))}}
{{ $json = (print "export default " $json  | safeJS )}}
{{ $r := resources.FromString "events/menu.js" $json }}
{{ $r.Publish }}
{{/*
  pedalp dates
*/}}
{{ $pedal := partial "buildPedalDates.html" . }}
{{ $pjson := ( $pedal | jsonify (dict "prefix" " " "indent" "  "))}}
{{ $pjson = (print "export default " $pjson  | safeJS )}}
{{ $pr := resources.FromString "events/pedalp.js" $pjson }}
{{ $pr.Publish }}

{{/* the vue app injects itself here. */}}
<div id="app" class="c-app"></div>
{{ partial "cal/dayjs.html" . }}
{{/* the vue app javascript. FIX: | minify  */}}
{{ $calMain := resources.Get "js/cal/calMain.js" }}
<script type="module" src="{{ $calMain.RelPermalink }}"></script>
{{ end }}